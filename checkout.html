<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout - Giovanna Joias</title>
  <style>
    * {
      box-sizing: border-box;
    }
    html, body {
      margin: 0; padding: 0; height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f7fb;
    }
    .container {
      max-width: 600px;
      margin: 40px auto 60px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 30px 25px 40px;
      min-height: 680px;
      display: flex;
      flex-direction: column;
    }
    .steps {
      display: flex;
      justify-content: space-between;
      margin-bottom: 40px;
      user-select: none;
    }
    .step {
      flex: 1;
      text-align: center;
      position: relative;
      font-weight: 600;
      color: #7ac7f9;
      font-size: 14px;
      text-transform: uppercase;
      cursor: default;
    }
    .step:not(:last-child)::after {
      content: '';
      position: absolute;
      top: 50%;
      right: 0;
      width: 100%;
      height: 4px;
      background-color: #7ac7f9;
      transform: translateY(-50%);
      z-index: -1;
    }
    .step.active {
      color: #ff4d7a;
    }
    .step.active:not(:last-child)::after {
      background-color: #ff4d7a;
    }
    .step.completed {
      color: #ff4d7a;
    }
    .step.completed:not(:last-child)::after {
      background-color: #ff4d7a;
    }
    .step .circle {
      display: inline-block;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background-color: #7ac7f9;
      color: white;
      line-height: 28px;
      font-weight: bold;
      margin-bottom: 8px;
      transition: background-color 0.3s;
    }
    .step.active .circle,
    .step.completed .circle {
      background-color: #ff4d7a;
    }
    h1 {
      text-align: center;
      color: #ff4d7a;
      margin-bottom: 20px;
      font-weight: 700;
    }
    form > fieldset {
      border: none;
      padding: 0;
      margin: 0;
      display: none;
      flex-direction: column;
      flex-grow: 1;
    }
    form > fieldset.active {
      display: flex;
    }
    .produto-info {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 6px;
      margin-bottom: 30px;
      font-size: 18px;
      color: #444;
      text-align: center;
      box-shadow: inset 0 0 5px #ddd;
    }
    .produto-info strong {
      color: #ff4d7a;
    }
    .produto-imagem {
      width: 200px;
      height: 200px;
      margin: 0 auto 20px;
      object-fit: contain;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
      color: #444;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 11px 12px;
      margin-top: 6px;
      border: 1.8px solid #c5d6e8;
      border-radius: 6px;
      font-size: 15px;
      color: #333;
      transition: border-color 0.3s;
    }
    input:focus, select:focus {
      border-color: #ff4d7a;
      outline: none;
    }
    .buttons {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      gap: 15px;
    }
    button {
      flex: 1;
      background-color: #ff4d7a;
      color: white;
      padding: 14px;
      border: none;
      border-radius: 6px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s ease;
      box-shadow: 0 4px 8px rgba(255, 77, 122, 0.5);
    }
    button:hover:not(:disabled) {
      background-color: #e03d6a;
      box-shadow: 0 6px 12px rgba(224, 61, 106, 0.7);
    }
    button:disabled {
      background-color: #ffb5c1;
      cursor: not-allowed;
      box-shadow: none;
    }
    button.secondary {
      background-color: #7ac7f9;
      box-shadow: 0 4px 8px rgba(122, 199, 249, 0.5);
      color: #004a7f;
      font-weight: 600;
    }
    button.secondary:hover:not(:disabled) {
      background-color: #5aa7e6;
      box-shadow: 0 6px 12px rgba(90, 167, 230, 0.7);
    }
    .resumo-final p {
      font-size: 16px;
      margin: 8px 0;
      color: #333;
      word-wrap: break-word;
    }
    .resumo-final strong {
      color: #ff4d7a;
    }
    @media(max-width: 480px) {
      .container {
        margin: 20px 15px 40px;
        padding: 20px 15px 30px;
      }
      .produto-info {
        font-size: 16px;
      }
      button {
        font-size: 16px;
        padding: 12px;
      }
      .step {
        font-size: 12px;
      }
      .step .circle {
        width: 24px;
        height: 24px;
        line-height: 24px;
      }
      .buttons {
        flex-direction: column;
      }
      .buttons button {
        width: 100%;
      }
      .produto-imagem {
        width: 150px;
        height: 150px;
      }
    }
  </style>
</head>
<body>

<div class="container">

  <div class="steps">
    <div class="step active" data-step="1">
      <div class="circle">1</div>
      Produto
    </div>
    <div class="step" data-step="2">
      <div class="circle">2</div>
      Dados
    </div>
    <div class="step" data-step="3">
      <div class="circle">3</div>
      Pagamento
    </div>
    <div class="step" data-step="4">
      <div class="circle">4</div>
      Resumo
    </div>
  </div>

  <form id="formulario" novalidate>

    <fieldset data-step="1" class="active">
      <label for="produtoSelect" style="font-weight:700; font-size: 16px; margin-bottom: 10px;">Selecione a joia</label>
      <select id="produtoSelect" required>
        <option value="" disabled selected>-- Escolha um produto --</option>
        <option value="brinco" data-preco="320.00" data-img="https://i.ibb.co/r3pH5Dy/brinco-diamante.png">Brinco de Diamante</option>
        <option value="colar" data-preco="580.00" data-img="https://i.ibb.co/0J8XZ3X/colar-ouro.png">Colar de Ouro</option>
        <option value="anel" data-preco="450.00" data-img="https://i.ibb.co/jR3M31r/anel-prata.png">Anel de Prata</option>
      </select>

      <div class="produto-info" style="margin-top: 20px; text-align: center;">
        <img src="https://i.ibb.co/r3pH5Dy/brinco-diamante.png" alt="Imagem do Produto" id="produtoImagem" class="produto-imagem" />
        <p><strong>Produto:</strong> <span id="produto">Nenhum selecionado</span></p>
        <p><strong>Preço:</strong> R$ <span id="preco">0,00</span></p>
      </div>

      <div class="buttons" style="justify-content: flex-end; margin-top: 30px;">
        <button type="button" id="btnAvancar1" disabled>Próximo</button>
      </div>
    </fieldset>

    <fieldset data-step="2">
      <label for="nome">Nome completo</label>
      <input type="text" name="nome" id="nome" required placeholder="Seu nome completo" />

      <label for="cpf">CPF</label>
      <input type="text" name="cpf" id="cpf" required placeholder="Somente números" maxlength="11" pattern="\d{11}" title="Digite 11 números do CPF" inputmode="numeric" />

      <label for="nascimento">Data de nascimento</label>
      <input type="date" name="nascimento" id="nascimento" required max="" />

      <label for="rua">Rua</label>
      <input type="text" name="rua" id="rua" required placeholder="Nome da rua" />

      <div class="buttons" style="margin-top: 30px;">
        <button type="button" class="secondary" id="btnVoltar2">Voltar</button>
        <button type="button" id="btnAvancar2">Próximo</button>
      </div>
    </fieldset>

    <fieldset data-step="3">
      <label for="pagamento">Forma de pagamento</label>
      <select name="pagamento" id="pagamento" required>
        <option value="" disabled selected>-- Selecione --</option>
        <option value="Cartão de Crédito">Cartão de Crédito</option>
        <option value="Cartão de Débito">Cartão de Débito</option>
        <option value="Pix">Pix</option>
        <option value="À vista">À vista</option>
        <option value="Link de pagamento">Link de pagamento</option>
      </select>

      <div class="buttons" style="margin-top: 30px;">
        <button type="button" class="secondary" id="btnVoltar3">Voltar</button>
        <button type="submit" id="btnEnviar">Finalizar</button>
      </div>
    </fieldset>

    <fieldset data-step="4">
      <h1>Resumo do Pedido</h1>
      <div class="resumo-final" style="flex-grow:1; display:flex; flex-direction: column; justify-content: center; align-items: center;">
        <p><strong>Produto:</strong> <span id="resumoProduto"></span></p>
        <p><strong>Preço:</strong> R$ <span id="resumoPreco"></span></p>
        <p><strong>Nome:</strong> <span id="resumoNome"></span></p>
        <p><strong>CPF:</strong> <span id="resumoCPF"></span></p>
        <p><strong>Data de nascimento:</strong> <span id="resumoNascimento"></span></p>
        <p><strong>Rua:</strong> <span id="resumoRua"></span></p>
        <p><strong>Forma de pagamento:</strong> <span id="resumoPagamento"></span></p>
      </div>

      <div class="buttons" style="margin-top: 30px;">
        <button type="button" class="secondary" id="btnVoltar4">Voltar</button>
        <button type="button" id="btnConfirmar">Confirmar e Enviar WhatsApp</button>
      </div>
    </fieldset>

  </form>
</div>

<script>
  // Ajustar data máxima do nascimento para hoje
  const nascimentoInput = document.getElementById('nascimento');
  nascimentoInput.max = new Date().toISOString().split('T')[0];

  const steps = document.querySelectorAll('.step');
  const fieldsets = document.querySelectorAll('form > fieldset');
  const form = document.getElementById('formulario');

  let currentStep = 1;

  const produtoSelect = document.getElementById('produtoSelect');
  const produtoNome = document.getElementById('produto');
  const produtoPreco = document.getElementById('preco');
  const produtoImagem = document.getElementById('produtoImagem');
  const btnAvancar1 = document.getElementById('btnAvancar1');

  // Atualiza dados do produto selecionado
  produtoSelect.addEventListener('change', () => {
    const selecionado = produtoSelect.selectedOptions[0];
    if (!selecionado) return;

    const nome = selecionado.textContent;
    const preco = parseFloat(selecionado.dataset.preco);
    const img = selecionado.dataset.img;

    produtoNome.textContent = nome;
    produtoPreco.textContent = preco.toFixed(2).replace('.', ',');
    produtoImagem.src = img;

    btnAvancar1.disabled = false;
  });

  function showStep(step) {
    currentStep = step;
    fieldsets.forEach(f => f.classList.remove('active'));
    const fs = document.querySelector(`form > fieldset[data-step="${step}"]`);
    fs.classList.add('active');

    steps.forEach(s => {
      s.classList.remove('active');
      s.classList.remove('completed');
      if (parseInt(s.dataset.step) < step) s.classList.add('completed');
      if (parseInt(s.dataset.step) === step) s.classList.add('active');
    });
  }

  // Botões Avançar e Voltar
  btnAvancar1.addEventListener('click', () => {
    showStep(2);
  });

  document.getElementById('btnVoltar2').addEventListener('click', () => {
    showStep(1);
  });
  document.getElementById('btnAvancar2').addEventListener('click', () => {
    // Validação dos dados do cliente
    if(!form.nome.checkValidity()){
      alert("Por favor, preencha o nome corretamente.");
      form.nome.focus();
      return;
    }
    if(!form.cpf.checkValidity()){
      alert("Por favor, preencha o CPF com 11 números.");
      form.cpf.focus();
      return;
    }
    if(!form.nascimento.checkValidity()){
      alert("Por favor, preencha a data de nascimento corretamente.");
      form.nascimento.focus();
      return;
    }
    if(!form.rua.checkValidity()){
      alert("Por favor, preencha o nome da rua.");
      form.rua.focus();
      return;
    }
    showStep(3);
  });

  document.getElementById('btnVoltar3').addEventListener('click', () => {
    showStep(2);
  });

  // Envio do formulário - botão Finalizar
  form.addEventListener('submit', function(e){
    e.preventDefault();
    // Validação do pagamento
    if(!form.pagamento.checkValidity()){
      alert("Por favor, selecione a forma de pagamento.");
      form.pagamento.focus();
      return;
    }
    // Montar resumo
    document.getElementById('resumoProduto').textContent = produtoNome.textContent;
    document.getElementById('resumoPreco').textContent = produtoPreco.textContent;
    document.getElementById('resumoNome').textContent = form.nome.value;
    document.getElementById('resumoCPF').textContent = form.cpf.value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
    document.getElementById('resumoNascimento').textContent = form.nascimento.value.split('-').reverse().join('/');
    document.getElementById('resumoRua').textContent = form.rua.value;
    document.getElementById('resumoPagamento').textContent = form.pagamento.value;

    showStep(4);
  });

  document.getElementById('btnVoltar4').addEventListener('click', () => {
    showStep(3);
  });

  document.getElementById('btnConfirmar').addEventListener('click', () => {
    // Preparar mensagem para WhatsApp
    const msg = `*Pedido de Joia*\n` +
      `Produto: ${produtoNome.textContent}\n` +
      `Preço: R$${produtoPreco.textContent}\n` +
      `Nome: ${form.nome.value}\n` +
      `CPF: ${form.cpf.value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4')}\n` +
      `Data de Nascimento: ${form.nascimento.value.split('-').reverse().join('/')}\n` +
      `Rua: ${form.rua.value}\n` +
      `Forma de Pagamento: ${form.pagamento.value}`;

    // Número de telefone para envio - substitua pelo seu número com código do país
    const telefone = '5518996377806';

    const url = `https://wa.me/${telefone}?text=${encodeURIComponent(msg)}`;
    window.open(url, '_blank');
  });

</script>

</body>
</html>
